apply plugin: 'base'
apply plugin: 'groovy'
apply plugin: 'java'
apply plugin: 'application'


task toa () {
  doLast {
    def toa = new ToaRestClient()
    println (toa.get("event/1819-FIM-Q4"))
  }
}

task tba () {
  doLast {
    def tba = new TbaRestClient()
    //println (tba.getDistricts())

    tba.getEvents("2018fim").each { event ->
      println (event.key)
      //println (tba.getMatchKeys(event.key))

    }
    def event =  new EventData ("2018mimil")
    tba.getMatchKeys(event.eventKey).each { mk ->
      // get the match data from the internet
      def matchDataRaw = tba.getMatchData(mk)
      println (matchDataRaw.key)
      // println ("\n\n" + matchDataRaw + "\n\n")
      def matchData = new MatchData(matchDataRaw.key)
      matchData.eventKey = event.eventKey
      matchData.blueTeams = matchDataRaw.alliances.blue.team_keys
      matchData.blueScore = matchDataRaw.alliances.blue.score
      matchData.redTeams = matchDataRaw.alliances.red.team_keys
      matchData.redScore = matchDataRaw.alliances.red.score
      matchData.blueMatchData = matchDataRaw.score_breakdown.blue
      matchData.redMatchData = matchDataRaw.score_breakdown.red
      event.addMatch(matchData)
    }
    event.printThem()
  }
}
